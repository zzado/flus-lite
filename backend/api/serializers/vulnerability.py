from rest_framework import serializers
from flus_lite import settings
from api.models import *



class VulItemSerializer(serializers.ModelSerializer):
    class Meta:
        model = VulnerabilityItem
        fields = ['full_code', 'code', 'name', 'risk']

class POCSerializer(serializers.ModelSerializer):
    class Meta:
        model = POC
        fields = '__all__'

class VulnerabilitySerializer(serializers.ModelSerializer):
    vulnerability_item = VulItemSerializer(read_only=True)
    pocs = POCSerializer(many=True)
    class Meta:
        model = Vulnerability
        fields = '__all__'
    

