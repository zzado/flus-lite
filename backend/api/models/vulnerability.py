from django.db import models

class VulnerabilityAbstractModel(models.Model):
    status = models.TextField('현재상태', blank=True, default='')
    auto_result = models.CharField('자동분석결과', blank=True, max_length=10, default='')
    auto_result_reason = models.TextField('자동분석결과_검출사유', blank=True, default='')
    result = models.CharField('분석결과', max_length=10, blank=True, default='')
    check_method = models.TextField('점검방식', blank=True, default='')
    sampling = models.TextField('샘플링 자산', blank=True, default='')
    is_reported = models.BooleanField('전달', default=False, null=True)
    is_patched = models.BooleanField('조치여부', default=False, null=True)
    new_description = models.TextField('개별상세설명', blank=True, default='')
    new_solution = models.TextField('개별조치방법', blank=True, default='')
    gathering_data = models.TextField('수집정보', blank=True, default='')

    class Meta:
        abstract = True

class Vulnerability(VulnerabilityAbstractModel):
    project = models.ForeignKey('Project', on_delete=models.CASCADE,default=None)
    asset = models.ForeignKey('Asset', on_delete=models.CASCADE,default=None)
    vulnerability_item = models.ForeignKey('VulnerabilityItem',on_delete=models.CASCADE,default=None)
    is_test = models.BooleanField('분석환경',default=False,)
    needs_login = models.BooleanField('로그인',default=False)
    is_new = models.BooleanField('신규여부(신규/기존)',default=True,null=True)

    class Meta(VulnerabilityAbstractModel.Meta):
        ordering = ['asset__code', 'vulnerability_item__code']